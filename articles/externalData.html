<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding external data to ggseg plotting • ggseg</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adding external data to ggseg plotting">
<meta property="og:description" content="ggseg">
<meta property="og:image" content="https://lcbc-uio.github.io/ggseg/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggseg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ggseg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/externalData.html">Adding external data to ggseg plotting</a>
    </li>
    <li>
      <a href="../articles/freesurfer_files.html">Read in files from FreeSurfer</a>
    </li>
    <li>
      <a href="../articles/geom-sf.html">Using atlases with geom_sf</a>
    </li>
    <li>
      <a href="../articles/ggseg-old.html">Plotting brain atlases in ggplot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ggseg/ggseg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adding external data to ggseg plotting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ggseg/ggseg/blob/HEAD/vignettes/externalData.Rmd" class="external-link"><code>vignettes/externalData.Rmd</code></a></small>
      <div class="hidden name"><code>externalData.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Once you have covered the main functionality in <code>ggseg</code> you will want to use it to plot the results of your data. In order to do this, your data must adhere to certain specifications, so that <code>ggseg</code> can manage to merge your data with the atlas you are using. This means you need to be able to inspect and locate the way the regions you are working with are names in the internal atlas files. This vignette should provide the tools you need to figure these features out, and to manipulate your data to fit these requirements.</p>
</div>
<div class="section level2">
<h2 id="inspecting-the-atlas-labels">Inspecting the atlas labels<a class="anchor" aria-label="anchor" href="#inspecting-the-atlas-labels"></a>
</h2>
<p>There are several ways you can inspect what the data in the atlas looks like. While each atlas has some small differences, they all share six main columns:<br><strong>1. .long</strong> - x-axis<br><strong>2. .lat </strong>- y-axis<br><strong>3. .region </strong>- name of region/network<br><strong>4. .hemi</strong> - hemisphere (left or right)<br><strong>5. .side</strong> - side of view (medial, lateral, sagittal or axial)</p>
<p>Most atlases also have a <code>label</code> column, which are raw names assigned from the program run to segment/extract data. TO inspect the atlases, call them in the console.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ggseg/ggseg" class="external-link">ggseg</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required package: ggplot2</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'dplyr'</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:stats':</span>
<span class="co">## </span>
<span class="co">##     filter, lag</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     intersect, setdiff, setequal, union</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="va">dk</span></code></pre></div>
<pre><code><span class="co">## # dk cortical brain atlas</span>
<span class="co">##   regions: 35 </span>
<span class="co">##   hemispheres: left, right </span>
<span class="co">##   side views: lateral, medial </span>
<span class="co">##   palette: yes </span>
<span class="co">##   use: ggplot() + geom_brain() </span>
<span class="co">## ----</span>
<span class="co">##    hemi  side    region                label                   roi  </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> left  lateral bankssts              lh_bankssts             0002 </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> left  lateral caudal middle frontal lh_caudalmiddlefrontal  0004 </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> left  lateral fusiform              lh_fusiform             0008 </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> left  lateral inferior parietal     lh_inferiorparietal     0009 </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> left  lateral inferior temporal     lh_inferiortemporal     0010 </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> left  lateral lateral occipital     lh_lateraloccipital     0012 </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> left  lateral lateral orbitofrontal lh_lateralorbitofrontal 0013 </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> left  lateral middle temporal       lh_middletemporal       0016 </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> left  lateral pars opercularis      lh_parsopercularis      0019 </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> left  lateral pars orbitalis        lh_parsorbitalis        0020 </span>
<span class="co">## <span style="color: #949494;"># … with 76 more rows</span></span></code></pre>
<p>Further inspection of the atlas data can be explored by turning them into tibbles (or data.frames)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">dk</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 90 × 8</span></span>
<span class="co">##    atlas type     hemi  side    region     label roi                    geometry</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> dk    cortical left  lateral <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>    0001  (((84.32563 34.46407, 84…</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> dk    cortical left  lateral bankssts   lh_b… 0002  (((214.8215 108.8139, 21…</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> dk    cortical left  lateral caudal mi… lh_c… 0004  (((106.16 184.3144, 93.6…</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> dk    cortical left  lateral fusiform   lh_f… 0008  (((256.5481 48.35713, 24…</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> dk    cortical left  lateral inferior … lh_i… 0009  (((218.4373 161.6233, 21…</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> dk    cortical left  lateral inferior … lh_i… 0010  (((250.7745 70.75764, 24…</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> dk    cortical left  lateral lateral o… lh_l… 0012  (((277.4615 115.0523, 27…</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> dk    cortical left  lateral lateral o… lh_l… 0013  (((66.26648 69.56474, 56…</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> dk    cortical left  lateral middle te… lh_m… 0016  (((238.0128 91.25816, 23…</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> dk    cortical left  lateral pars oper… lh_p… 0019  (((79.03391 126.496, 74.…</span>
<span class="co">## <span style="color: #949494;"># … with 80 more rows</span></span></code></pre>
<p>Here you can see information about the <code>dk</code> atlas, and the main attributes of this atlas. If you want to use external data with your <code>ggseg</code> plot, you will need to make sure that your data has at least one column corresponding in name and content with another in the atlas you are using.</p>
</div>
<div class="section level2">
<h2 id="structuring-data-for-merging">Structuring data for merging<a class="anchor" aria-label="anchor" href="#structuring-data-for-merging"></a>
</h2>
<p>For instance, here we make some data for the “default” and “visual” networks in the <code>dk</code> atlas, and two p values for those two networks.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">someData</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  region<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"superior temporal"</span>,<span class="st">"precentral"</span>, <span class="st">"lateral orbitofrontal"</span><span class="op">)</span>,
  p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.03</span>,<span class="fl">.6</span>, <span class="fl">.05</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">someData</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="co">##   region                    p</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> superior temporal      0.03</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> precentral             0.6 </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> lateral orbitofrontal  0.05</span></code></pre>
<p>Notice you we have spelled both the column name and the region names <strong>exactly</strong> as they appear in the data. This is necessary for the merging within the <code>ggseg</code> function to work properly. This merge can be attempted before supplying the data to <code>ggseg</code> to see if there are any errors.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dk</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = "region"</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 90 × 9</span></span>
<span class="co">##    atlas type     hemi  side  region label roi                    geometry     p</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> dk    cortical left  late… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    0001  (((84.32563 34.46407, 84… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> dk    cortical left  late… banks… lh_b… 0002  (((214.8215 108.8139, 21… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> dk    cortical left  late… cauda… lh_c… 0004  (((106.16 184.3144, 93.6… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> dk    cortical left  late… fusif… lh_f… 0008  (((256.5481 48.35713, 24… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> dk    cortical left  late… infer… lh_i… 0009  (((218.4373 161.6233, 21… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> dk    cortical left  late… infer… lh_i… 0010  (((250.7745 70.75764, 24… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> dk    cortical left  late… later… lh_l… 0012  (((277.4615 115.0523, 27… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> dk    cortical left  late… later… lh_l… 0013  (((66.26648 69.56474, 56…  0.05</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> dk    cortical left  late… middl… lh_m… 0016  (((238.0128 91.25816, 23… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> dk    cortical left  late… pars … lh_p… 0019  (((79.03391 126.496, 74.… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #949494;"># … with 80 more rows</span></span></code></pre>
<p>No errors! Yes, the <code>p</code> column is seemingly full of <code>NA</code>s, but that is just because the top of the data is the somatomotor network, which we did not supply any p values for, so it has been populated with <code>NA</code>s. We can sort the data differently, so we can see the <code>p</code>has been added correctly.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dk</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = "region"</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 90 × 9</span></span>
<span class="co">##    atlas type     hemi  side  region label roi                    geometry     p</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> dk    cortical left  late… super… lh_s… 0031  (((207.634 112.8177, 195…  0.03</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> dk    cortical right late… super… rh_s… 0031  (((1201.097 114.4479, 12…  0.03</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> dk    cortical left  late… later… lh_l… 0013  (((66.26648 69.56474, 56…  0.05</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> dk    cortical left  medi… later… lh_l… 0013  (((571.041 20.11423, 571…  0.05</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> dk    cortical right medi… later… rh_l… 0013  (((770.9836 30.46747, 77…  0.05</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> dk    cortical right late… later… rh_l… 0013  (((1321.97 75.4817, 1320…  0.05</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> dk    cortical left  late… prece… lh_p… 0025  (((157.1559 204.0537, 13…  0.6 </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> dk    cortical left  medi… prece… lh_p… 0025  (((476.8878 196.7183, 48…  0.6 </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> dk    cortical right medi… prece… rh_p… 0025  (((923.7245 201.5463, 92…  0.6 </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> dk    cortical right late… prece… rh_p… 0025  (((1226.19 203.939, 1230…  0.6 </span>
<span class="co">## <span style="color: #949494;"># … with 80 more rows</span></span></code></pre>
<p>If you need your data to be matched on several columns, the approach is the same. Add the column you want to match on, with the <strong>exact</strong> same name, and make sure it’s content matches the content of the same column in the data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">someData</span><span class="op">$</span><span class="va">hemi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span><span class="op">)</span>
<span class="va">someData</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">##   region                    p hemi </span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> superior temporal      0.03 left </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> precentral             0.6  left </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> lateral orbitofrontal  0.05 left</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dk</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = c("hemi", "region")</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 90 × 9</span></span>
<span class="co">##    atlas type     hemi  side  region label roi                    geometry     p</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> dk    cortical left  late… super… lh_s… 0031  (((207.634 112.8177, 195…  0.03</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> dk    cortical left  late… later… lh_l… 0013  (((66.26648 69.56474, 56…  0.05</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> dk    cortical left  medi… later… lh_l… 0013  (((571.041 20.11423, 571…  0.05</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> dk    cortical left  late… prece… lh_p… 0025  (((157.1559 204.0537, 13…  0.6 </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> dk    cortical left  medi… prece… lh_p… 0025  (((476.8878 196.7183, 48…  0.6 </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> dk    cortical left  late… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    0001  (((84.32563 34.46407, 84… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> dk    cortical left  late… banks… lh_b… 0002  (((214.8215 108.8139, 21… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> dk    cortical left  late… cauda… lh_c… 0004  (((106.16 184.3144, 93.6… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> dk    cortical left  late… fusif… lh_f… 0008  (((256.5481 48.35713, 24… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> dk    cortical left  late… infer… lh_i… 0009  (((218.4373 161.6233, 21… <span style="color: #BB0000;">NA</span>   </span>
<span class="co">## <span style="color: #949494;"># … with 80 more rows</span></span></code></pre>
<p>Notice how the message now states that it is joining <code>by = c("region", "hemi")</code>. The merge function has recognized that there are two equally named columns, and assumes (in this case correctly) that these are equivalent.<br><strong>Notice</strong> that everything is case-sensitive, so writing <code>Region</code> or <code>Left</code> will not result in matching.</p>
</div>
<div class="section level2">
<h2 id="providing-data-to-ggseg">Providing data to <code>ggseg</code><a class="anchor" aria-label="anchor" href="#providing-data-to-ggseg"></a>
</h2>
<p>When you have managed to create data that merges nicely with the atlas, you can go ahead and supply it to the function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span> atlas<span class="op">=</span><span class="va">dk</span>, mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## merging atlas and data by 'region', 'hemi'</span></code></pre>
<p><img src="externalData_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>You can actually also supply it directly as an atlas. For instance, if you had saved the merged data from the previous steps, you can supply this directly to the <code>atlas</code> option.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newAtlas</span> <span class="op">=</span> <span class="va">dk</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/as_brain_atlas.html">as_brain_atlas</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = c("hemi", "region")</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="va">newAtlas</span>, 
             mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">p</span><span class="op">)</span>, 
             position <span class="op">=</span> <span class="fu"><a href="../reference/position_brain.html">position_brain</a></span><span class="op">(</span><span class="va">hemi</span> <span class="op">~</span> <span class="va">side</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="externalData_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>It is this possibility of supplying a custom atlas that gives you particular flexibility, though a little tricky to begin with. Lets do a recap of the unwanted results:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">someData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"transverse temporal"</span>, <span class="st">"insula"</span>,
               <span class="st">"precentral"</span>,<span class="st">"superior parietal"</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, 
  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.5</span>,<span class="fl">.001</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span>,
  AgeG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Young"</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Old"</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span> <span class="op">+</span>   
  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="va">dk</span>, 
             colour<span class="op">=</span><span class="st">"white"</span>, 
             mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">AgeG</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## merging atlas and data by 'region'</span></code></pre>
<p><img src="externalData_files/figure-html/datasupp3-1.png" width="700"></p>
<p>See how you have three facets, when you only have 2 groups, and that the “background” brain is not printed in your two groups. This is because for ggplot, that is what the data looks like. For this to work, you can supply already grouped data to <code>ggseg</code>, but you must make sure they are grouped by the columns you will use for faceting, or else it will not work.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># If you group_by the columns you will facet by, this will work well.</span>
<span class="va">someData</span> <span class="op">=</span> <span class="va">someData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">AgeG</span><span class="op">)</span>

<span class="co"># We can now supply the newAtlas as an atlas to ggseg</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">someData</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas<span class="op">=</span><span class="va">dk</span>, 
             colour<span class="op">=</span><span class="st">"white"</span>,
             mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">AgeG</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"royalblue"</span>,<span class="st">"firebrick"</span>,<span class="st">"goldenrod"</span><span class="op">)</span>,na.value<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## merging atlas and data by 'region'</span></code></pre>
<p><img src="externalData_files/figure-html/duplicate-1.png" width="700"></p>
<p>This whole procedure can be piped together, so you don’t have to save all the intermediate steps.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">someData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">AgeG</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 

  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/ggbrain.html">geom_brain</a></span><span class="op">(</span>atlas<span class="op">=</span><span class="va">dk</span>, 
             colour<span class="op">=</span><span class="st">"white"</span>, 
             mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">AgeG</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"royalblue"</span>,<span class="st">"firebrick"</span>,<span class="st">"goldenrod"</span><span class="op">)</span>,na.value<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## merging atlas and data by 'region'</span></code></pre>
<p><img src="externalData_files/figure-html/duplicatepipe-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Athanasia Mo Mowinckel, Didac Vidal-Piñeiro.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
