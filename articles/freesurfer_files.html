<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read in files from FreeSurfer • ggseg</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Read in files from FreeSurfer">
<meta property="og:description" content="ggseg">
<meta property="og:image" content="https://lcbc-uio.github.io/ggseg/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggseg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ggseg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/externalData.html">Adding external data to ggseg plotting</a>
    </li>
    <li>
      <a href="../articles/freesurfer_files.html">Read in files from FreeSurfer</a>
    </li>
    <li>
      <a href="../articles/geom-sf.html">Using atlases with geom_sf</a>
    </li>
    <li>
      <a href="../articles/ggseg-old.html">Plotting brain atlases in ggplot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ggseg/ggseg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Read in files from FreeSurfer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ggseg/ggseg/blob/HEAD/vignettes/freesurfer_files.Rmd" class="external-link"><code>vignettes/freesurfer_files.Rmd</code></a></small>
      <div class="hidden name"><code>freesurfer_files.Rmd</code></div>

    </div>

    
    
<p>FreeSurfer already have files that are compatible with <code>ggseg</code> in some extent. There are naming conventions and file-formats that are different, and as such it can at times be a little tricky to get data directly from FreeSurfer into R, and subsequently plotting in ggseg.</p>
<div class="section level2">
<h2 id="raw-stats-files">Raw stats files<a class="anchor" aria-label="anchor" href="#raw-stats-files"></a>
</h2>
<div class="section level3">
<h3 id="read-in-single-raw-stats-file">Read in single raw stats file<a class="anchor" aria-label="anchor" href="#read-in-single-raw-stats-file"></a>
</h3>
<p>If <code>recon-all</code> from FreeSurfer has been run, each participant should have a <code>stats</code> folder, with various parcellation data and summary statistics for those parcellations and measures. These have many header lines before the data actually start, and can have some formatting difficult to handle in R.</p>
<p>The function <code>read_freesurfer_stats</code> is made to easily read in raw stats tables from each individual, without needing to go through FreeSurfer’s internal converters. When using this file, remembering which hemisphere is read in is important, as this information must be added to the <code>label</code> column for <code>ggseg</code> to recognise the region labels.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ggseg/ggseg" class="external-link">ggseg</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="va">subjects_dir</span> <span class="op">&lt;-</span> <span class="st">"/Applications/freesurfer/subjects/"</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stats_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subjects_dir</span>, <span class="st">"bert/stats/lh.aparc.stats"</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_freesurfer_stats.html">read_freesurfer_stats</a></span><span class="op">(</span><span class="va">stats_file</span><span class="op">)</span>
<span class="va">data</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 34 × 10</span></span>
<span class="co">#&gt;    label    NumVert SurfArea GrayVol ThickAvg ThickStd MeanCurv GausCurv FoldInd</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> bankssts    <span style="text-decoration: underline;">1</span>181      831    <span style="text-decoration: underline;">2</span>297     2.77    0.428    0.116    0.024      11</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> caudala…     843      572    <span style="text-decoration: underline;">1</span>534     2.72    0.469    0.124    0.013      10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> caudalm…    <span style="text-decoration: underline;">2</span>758     <span style="text-decoration: underline;">1</span>840    <span style="text-decoration: underline;">5</span>772     2.80    0.526    0.114    0.021      26</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> cuneus      <span style="text-decoration: underline;">2</span>683     <span style="text-decoration: underline;">1</span>654    <span style="text-decoration: underline;">3</span>074     1.81    0.471    0.14     0.033      39</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> entorhi…     581      416    <span style="text-decoration: underline;">1</span>840     3.33    0.667    0.116    0.032       5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> fusiform    <span style="text-decoration: underline;">4</span>113     <span style="text-decoration: underline;">2</span>875    <span style="text-decoration: underline;">8</span>519     2.72    0.599    0.131    0.025      52</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> inferio…    <span style="text-decoration: underline;">4</span>948     <span style="text-decoration: underline;">3</span>466   <span style="text-decoration: underline;">10</span>559     2.70    0.509    0.131    0.029      65</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> inferio…    <span style="text-decoration: underline;">5</span>056     <span style="text-decoration: underline;">3</span>542   <span style="text-decoration: underline;">12</span>358     2.98    0.625    0.138    0.033      74</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> isthmus…    <span style="text-decoration: underline;">1</span>561      990    <span style="text-decoration: underline;">2</span>350     2.09    0.745    0.113    0.023      19</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> lateral…    <span style="text-decoration: underline;">7</span>961     <span style="text-decoration: underline;">5</span>077   <span style="text-decoration: underline;">12</span>743     2.30    0.588    0.139    0.033     104</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 24 more rows, and 1 more variable: CurvInd &lt;dbl&gt;</span></span></code></pre></div>
<p>This data should be well-suited for use with ggseg.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"lh_"</span>, <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/ggseg.html">ggseg</a></span><span class="op">(</span>atlas <span class="op">=</span> <span class="va">dk</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">ThickAvg</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; merging atlas and data by 'label'</span></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="read-in-raw-stats-files-for-an-atlas-for-all-subjects">Read in raw stats files for an atlas for all subjects<a class="anchor" aria-label="anchor" href="#read-in-raw-stats-files-for-an-atlas-for-all-subjects"></a>
</h3>
<p>A convenience function also exists for those wanting to circumvent the <code>aparcstats2table</code> and <code>asegstats2table</code> from freesurfer for creating larger datasets of all subjects for a specific parcellation and metric. Using the function <code>read_freesurfer_stats</code>, <code>read_atlas_files</code> uses regular expression for the atlas you want to extract data from, and grabs this data from all available subjects. Be careful with your pattern matching to be sure you get exactly the atlas you want. For instance, there are several atlases with with string <code>aparc</code> in them. So in order to get only the default aparc stats, we need to specify <code>aparc.stats$</code>, which will only read those files ending with that particular string. This function <em>can</em> throw warnings, which is most cases can be ignored.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_atlas_files.html">read_atlas_files</a></span><span class="op">(</span><span class="va">subject_dir</span>, <span class="st">"aparc.stats$"</span><span class="op">)</span>
<span class="va">dat</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 68 × 11</span></span>
<span class="co">#&gt;    subject label    NumVert SurfArea GrayVol ThickAvg ThickStd MeanCurv GausCurv</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> bert    lh_bank…    <span style="text-decoration: underline;">1</span>181      831    <span style="text-decoration: underline;">2</span>297     2.77    0.428    0.116    0.024</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> bert    lh_caud…     843      572    <span style="text-decoration: underline;">1</span>534     2.72    0.469    0.124    0.013</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> bert    lh_caud…    <span style="text-decoration: underline;">2</span>758     <span style="text-decoration: underline;">1</span>840    <span style="text-decoration: underline;">5</span>772     2.80    0.526    0.114    0.021</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> bert    lh_cune…    <span style="text-decoration: underline;">2</span>683     <span style="text-decoration: underline;">1</span>654    <span style="text-decoration: underline;">3</span>074     1.81    0.471    0.14     0.033</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> bert    lh_ento…     581      416    <span style="text-decoration: underline;">1</span>840     3.33    0.667    0.116    0.032</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> bert    lh_fusi…    <span style="text-decoration: underline;">4</span>113     <span style="text-decoration: underline;">2</span>875    <span style="text-decoration: underline;">8</span>519     2.72    0.599    0.131    0.025</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> bert    lh_infe…    <span style="text-decoration: underline;">4</span>948     <span style="text-decoration: underline;">3</span>466   <span style="text-decoration: underline;">10</span>559     2.70    0.509    0.131    0.029</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> bert    lh_infe…    <span style="text-decoration: underline;">5</span>056     <span style="text-decoration: underline;">3</span>542   <span style="text-decoration: underline;">12</span>358     2.98    0.625    0.138    0.033</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> bert    lh_isth…    <span style="text-decoration: underline;">1</span>561      990    <span style="text-decoration: underline;">2</span>350     2.09    0.745    0.113    0.023</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> bert    lh_late…    <span style="text-decoration: underline;">7</span>961     <span style="text-decoration: underline;">5</span>077   <span style="text-decoration: underline;">12</span>743     2.30    0.588    0.139    0.033</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 58 more rows, and 2 more variables: FoldInd &lt;int&gt;, CurvInd &lt;dbl&gt;</span></span></code></pre></div>
<p>Since all files are read in, the hemisphere in the label is already fixed, so it is easy to plot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggseg.html">ggseg</a></span><span class="op">(</span><span class="va">dat</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">ThickStd</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; merging atlas and data by 'label'</span></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>With this data, we can even have a look at all the metrics at once.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>

<span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">stat</span>, <span class="va">val</span>, <span class="op">-</span><span class="va">subject</span>, <span class="op">-</span><span class="va">label</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/ggseg.html">ggseg</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">val</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">stat</span><span class="op">)</span>
<span class="co">#&gt; merging atlas and data by 'label'</span></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="freesurfer-stats-tables">FreeSurfer stats tables<a class="anchor" aria-label="anchor" href="#freesurfer-stats-tables"></a>
</h2>
<p>FreeSurfer has internal functions to convert their raw stats files into tables, gather subject into a single data file with particular metric. It is quite common to use these files, but again the formatting is not something R is very happy with. The function <code><a href="../reference/read_freesurfer_table.html">read_freesurfer_table()</a></code> is for easier import of these files, particularly for further plotting with ggseg.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Path to our particular file, yours will be wherever you have saved it</span>
<span class="va">table_path</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"tests/testthat/data/aparc.volume.table"</span><span class="op">)</span>
<span class="va">table_path</span>
<span class="co">#&gt; [1] "/Users/runner/work/ggseg/ggseg/tests/testthat/data/aparc.volume.table"</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_freesurfer_table.html">read_freesurfer_table</a></span><span class="op">(</span><span class="va">table_path</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 36 × 3</span></span>
<span class="co">#&gt;    subject label                             value</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> bert    rh_bankssts_volume                 <span style="text-decoration: underline;">1</span>969</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> bert    rh_caudalanteriorcingulate_volume  <span style="text-decoration: underline;">2</span>280</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> bert    rh_caudalmiddlefrontal_volume      <span style="text-decoration: underline;">5</span>390</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> bert    rh_cuneus_volume                   <span style="text-decoration: underline;">2</span>998</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> bert    rh_entorhinal_volume               <span style="text-decoration: underline;">1</span>735</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> bert    rh_fusiform_volume                 <span style="text-decoration: underline;">8</span>144</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> bert    rh_inferiorparietal_volume        <span style="text-decoration: underline;">14</span>876</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> bert    rh_inferiortemporal_volume        <span style="text-decoration: underline;">11</span>016</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> bert    rh_isthmuscingulate_volume         <span style="text-decoration: underline;">1</span>983</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> bert    rh_lateraloccipital_volume        <span style="text-decoration: underline;">12</span>729</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 26 more rows</span></span></code></pre></div>
<p>The file is read and has three columns only. The subject column, the label column, and a column with the values of the metric. Since the stats tables can contain different measures, and these are handled somewhat differently, we for convenience leave the default reading of the table this way. To work with ggseg, though, the labels usually (but not always) need a little cleaning. In this case we read in a <code>volume</code> table, and as such all labels end with “_volume”. ggseg will <em>not</em> recognise this matching the atlas, and will therefore not plot.</p>
<p>Easiest way to clean, is by using the <code>measure</code> argument for the function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_freesurfer_table.html">read_freesurfer_table</a></span><span class="op">(</span><span class="va">table_path</span>, measure <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span>
<span class="va">dat</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 36 × 3</span></span>
<span class="co">#&gt;    subject label                      volume</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> bert    rh_bankssts                  <span style="text-decoration: underline;">1</span>969</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> bert    rh_caudalanteriorcingulate   <span style="text-decoration: underline;">2</span>280</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> bert    rh_caudalmiddlefrontal       <span style="text-decoration: underline;">5</span>390</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> bert    rh_cuneus                    <span style="text-decoration: underline;">2</span>998</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> bert    rh_entorhinal                <span style="text-decoration: underline;">1</span>735</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> bert    rh_fusiform                  <span style="text-decoration: underline;">8</span>144</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> bert    rh_inferiorparietal         <span style="text-decoration: underline;">14</span>876</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> bert    rh_inferiortemporal         <span style="text-decoration: underline;">11</span>016</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> bert    rh_isthmuscingulate          <span style="text-decoration: underline;">1</span>983</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> bert    rh_lateraloccipital         <span style="text-decoration: underline;">12</span>729</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 26 more rows</span></span></code></pre></div>
<p>This will do two things: 1) remove the label suffix, and 2) rename the <code>value</code> column to the measure supplied. Alternatively, you will need to do string manipulation on the label column your self, we recommend the <a href="https://stringr.tidyverse.org/index.html" class="external-link">stringr</a> package in that case.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/ggseg.html">ggseg</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">volume</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>An error will be thrown because the FreeSurfer tables also include measures of total volume/region/thickness, estimated intracranial volume etc, which will not merge into the atlas, and the internal ggseg atlas-merging function throws a warning. To avoid this, you can remove those labels before plotting.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"lh|rh"</span>, <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/ggseg.html">ggseg</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">volume</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; merging atlas and data by 'label'</span></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Athanasia Mo Mowinckel, Didac Vidal-Piñeiro.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
